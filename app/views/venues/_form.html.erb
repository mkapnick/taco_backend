<%= form_for(@venue) do |f| %>
  <% if @venue.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@venue.errors.count, "error") %> prohibited this venue from being saved:</h2>

      <ul>
      <% @venue.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>



   <div class="field">
    <%= f.label :venue_name %><br />
    <%= f.text_field :venue_name %>
  </div>
  
  <div class="field">
    <%= f.label :website %><br />
    <%= f.text_field :website %>
  </div>
  
   <!-- <div class="field">
    
  </div> -->

<div class="ui-widget">
  <%= f.label :tags %><br />
 <input id="tags" <%= f.text_field :tags %> >

</div>

<body>
  <div id="chart_div" style="width: 600px; height: 200px; position: relative; left: 15%; "></div>
</body>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
<link rel="stylesheet" href="/resources/demos/style.css" />

  Tags used so far: 
 
  <%
  occurences =0 
  result = JSON.parse open('http://nyt-project-taco.herokuapp.com/venues.json').read
  tagsArrayList = Array.new
  hashList = Array.new
  hash=Hash.new #out here to make it global
  
  result.each { |i| 
    tags = i.fetch('tags')
    hash = Hash.new
    if (tags != "insert")
        words = tags.split(',')     
        words.each do |word|
        word = word.downcase %>
          <%= "#{word}" %>
          <%
          if (!tagsArrayList.include?(word))
              hash[word] = 1
              tagsArrayList.push(word)
              hashList.push(hash)
          else
            %>
            <p> IN ELSE: </p> <%= "#{word}"%> ------ <%= "#{tagsArrayList.count(word)}"%>
            <%
            hash[word] = tagsArrayList.count(word)
            hashList.push(hash)
          end
        end
    end


    # Massive and unneccessary, but gets the job done!

  }

    v1 = hashList[0]["organic"]
    v2=hashList[1]["lunch"]
    v3=hashList[2]["brunch"]
    v4=hashList[3]["cocktail"]
    v5=hashList[4]["dessert"]
    v6=hashList[5]["bar"]
    v7=hashList[6]["dinner"]
    v8=hashList[7]["wine"]
    v9=hashList[8]["local"]
    v10=hashList[9]["american"]
    v11=hashList[10]["nordic"]
    v12=hashList[11]["happy-hour"]
    v13=hashList[12]["cocktails"]
    v14=hashList[13]["beer"]
    v15=hashList[14]["indian"]
    v16=hashList[15]["indoor"]
    v17=hashList[16]["lounge"]
    v18=hashList[17]["cheese"]
    v19=hashList[18]["private"]
    v20=hashList[19]["tasting"]
    v21=hashList[20]["italian"]
    v22=hashList[21]["french"]
    v23=hashList[22]["breakfast"]
    v24=hashList[23]["desserts"]
    v25=hashList[24]["steakhouse"]
    v26=hashList[25]["sushi"]
    v27=hashList[26]["drinks"]
  %>


  
 <script type="text/javascript">
      $(function() {
      var array = [
      "organic",
      "lunch",
      "brunch",
      "cocktail",
      "dessert",
      "bar",
      "dinner",
      "wine",
      "local",
      "american", 
      "nordic",
      "happy-hour",
      "cocktails",
      "beer",
      "indian",
      "indoor", 
      "lounge",
      "cheese", 
      "private", 
      "tasting", 
      "italian",
      "french",
      "breakfast",
      "desserts",
      "steakhouse", 
      "sushi",
      "drinks"

    ];

     $( "#tags" ).autocomplete({
      source: array
    });

    });

 </script>

 
  <select>
    <%
      tagsArrayList.each do |x|
    %> 
         <option value= <%= "#{x}" %>> <%= "#{x}" %> </option> 
    <% end  %> 
 </select> 
 


  <div class="field">
    <%= f.label :latitude %><br />
    <%= f.text_field :latitude %>
  </div>
  <div class="field">
    <%= f.label :longitude %><br />
    <%= f.text_field :longitude %>
  </div>
  <div class="field">
    <%= f.label :nytID %><br />
    <%= f.text_field :nytID %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>



 
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(function(){drawChart('<%= "#{v1}"%>','<%="#{v2}"%>','<%="#{v3}"%>','<%="#{v4}"%>','<%="#{v5}"%>','<%="#{v6}"%>','<%="#{v7}"%>','<%="#{v8}"%>','<%="#{v9}"%>','<%="#{v10}"%>','<%="#{v11}"%>','<%="#{v12}"%>','<%="#{v13}"%>','<%="#{v14}"%>','<%="#{v15}"%>','<%="#{v16}"%>','<%="#{v17}"%>','<%="#{v18}"%>','<%="#{v19}"%>','<%="#{v20}"%>','<%="#{v21}"%>','<%="#{v22}"%>','<%="#{v23}"%>','<%="#{v24}"%>','<%="#{v25}"%>','<%="#{v26}"%>','<%="#{v27}"%>')});
      function drawChart(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20,v21,v22,v23,v24,v25,v26,v27) {
        //alert (v1);
        var data = google.visualization.arrayToDataTable([
          ['Name', 'Occurences'],
          ['organic', parseInt(v1)],
          ['lunch', parseInt(v2)],
          ['brunch', parseInt(v3)],
          ['cocktail', parseInt(v4)],
          ['dessert', parseInt(v5)],
          ['bar', parseInt(v6)],
          ['dinner', parseInt(v7)],
          ['wine', parseInt(v8)],
          ['local', parseInt(v9)],
          ['american', parseInt(v10)],
          ['nordic', parseInt(v11)],
          ['happy-hour', parseInt(v12)],
          ['cocktails', parseInt(v13)],
          ['beer', parseInt(v14)],
          ['indian', parseInt(v15)],
          ['indoor', parseInt(v16)],
          ['lounge', parseInt(v17)],
          ['cheese', parseInt(v18)],
          ['private', parseInt(v19)],
          ['tasting', parseInt(v20)],
          ['italian', parseInt(v21)],
          ['french',  parseInt(v22)],
          ['breakfast', parseInt(v23)],
          ['desserts', parseInt(v24)],
          ['steakhouse', parseInt(v25)],
          ['sushi', parseInt(v26)],
          ['drinks', parseInt(v27)]
          ]);
        var options = {
          title: 'Tag Occurences',
          hAxis: {slantedTextAngle: 90, maxTextLines: 10, title: 'Tag Name', titleTextStyle: {color: 'black'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>

  








<% end %>


